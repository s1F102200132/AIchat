<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>

   {% load static %}
   <link rel="stylesheet" type="text/css" href="{% static 'blog/style.css' %}">

   <script src="https://code.jquery.com/jquery-3.7.1.js" integrity="sha256-eKhayi8LEQwp4NKxN+CfCh+3qOVUtJn3QNZ0TciWLP4=" crossorigin="anonymous"></script>
</head>
<body>
    <h1 class="lang" data-ja="AIãƒãƒ£ãƒƒãƒˆãƒœãƒƒãƒˆ" data-en="AI Chatbot">AIãƒãƒ£ãƒƒãƒˆãƒœãƒƒãƒˆ</h1>

    <button onclick="setLanguage('ja')" class="lang-btn">æ—¥æœ¬èª</button>
    <button onclick="setLanguage('en')" class="lang-btn">English</button>


    <div>
        <div id="chatbot">
            <p class="botText lang" data-ja="ã“ã‚“ã«ã¡ã¯ï¼" data-en="Hi there!"><span>ã“ã‚“ã«ã¡ã¯ï¼</span></p>
        </div>
        <div id="userInput">
            <input type="text" id="textInput" name="userMessage" placeholder="ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„..." data-placeholder-ja="ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„..." data-placeholder-en="Type your message..." />
            <input type="submit" value="é€ä¿¡" id="buttonInput" class="lang" data-ja="é€ä¿¡" data-en="Send" />
        </div>
    </div>


    <script>

        function getUserResponse(){
            var userText = $('#textInput').val().trim();
            if (userText === "") return;  // ç©ºæ–‡å­—ãªã‚‰é€ä¿¡ã—ãªã„
        
            var userHTML = "<p class='userText'>User: <span>"+userText+"</span></p>";
            $('#textInput').val("");
            $('#chatbot').append(userHTML);
        
            $.get('/blog/getResponse',{userMessage:userText}).done(function(data){
                var returnedMessage = "<p class='botText'>Chatbot: <span>"+ data + "</span></p>";
                $('#chatbot').append(returnedMessage);
        
                // ğŸ‘‡ è‡ªå‹•ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«ã‚‚è¿½åŠ ï¼ˆæ¬¡é …ï¼‰
                $('#chatbot').scrollTop($('#chatbot')[0].scrollHeight);
            });
        }
        


      $('#buttonInput').click(function(){
        getUserResponse();

      })

      function setLanguage(lang) {
        document.querySelectorAll('.lang').forEach(el => {
          const text = el.getAttribute(`data-${lang}`);
          if (text !== null) {
            if (el.tagName.toLowerCase() === 'input') {
              el.value = text;
            } else {
              el.innerHTML = text;
            }
          }
        });
    
        // ãƒ—ãƒ¬ãƒ¼ã‚¹ãƒ›ãƒ«ãƒ€ã‚‚å¤‰ãˆã‚‹
        const input = document.getElementById('textInput');
        if (input) {
          input.placeholder = input.getAttribute(`data-placeholder-${lang}`); 
        }
      }
    
      // åˆæœŸã¯æ—¥æœ¬èªã«è¨­å®š
      window.onload = function() {
        setLanguage('ja');
      }
        
    </script>

</body>
</html>