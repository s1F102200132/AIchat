<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <title>AIチャットボット</title>

    {% load static %}
    <link rel="stylesheet" type="text/css" href="{% static 'blog/style.css' %}">

    <script src="https://code.jquery.com/jquery-3.7.1.js"></script>
</head>
<body>
<div class="chat-container">
    <div id="chatbox" class="chat-box">
        <!-- 初期メッセージはJS側で追加されます -->
    </div>
    <div class="input-area">
        <input type="text" id="textInput" placeholder="メッセージを入力..." />
        <button id="sendBtn">送信</button>
    </div>
</div>

<script>
    // メッセージをチャット画面に追加
    function appendMessage(text, sender) {
        const msgClass = sender === 'bot' ? 'bot' : 'user';
        $('#chatbox').append(`
            <div class="message ${msgClass}">
                <span>${text}</span>
            </div>
        `);
        $('#chatbox').scrollTop($('#chatbox')[0].scrollHeight);  // スクロール
    }

    // ユーザー送信処理
    function sendMessage() {
        const userText = $('#textInput').val().trim();
        if (!userText) return;

        appendMessage(userText, 'user');
        $('#textInput').val('');

        $.get('/blog/getResponse', { userMessage: userText }, function(data) {
            appendMessage(data, 'bot');
        });
    }

    // 初期Botメッセージ
    $(document).ready(function () {
        appendMessage("こんにちは！ご質問はありますか？", "bot");

        $('#sendBtn').click(sendMessage);
        $('#textInput').keypress(function (e) {
            if (e.which === 13) sendMessage();
        });
    });
</script>
</body>
</html>
